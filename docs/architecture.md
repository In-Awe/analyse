# Phase V — High-Performance Trading Bot Architecture

This document describes the modular, event-driven architecture for the Phase V implementation of the HFT trading system.

## Overview

The system is composed of decoupled modules communicating via a message bus. Core modules:
- Market Data Handler (WebSocket) — ingests real-time kline and trade streams and normalizes them into internal messages.
- Signal Generation — consumes feature pipeline outputs and the predictive model to emit BUY/SELL/FLAT signals.
- Risk Manager — converts signals into target positions, applies risk limits and position sizing rules.
- Order Executor — executes orders against Binance REST API, manages order lifecycle & reconciliation.
- Telemetry & Monitoring — collects metrics, exposes Prometheus endpoints and alerts.

## Communication

For single-host testing, use Redis Streams or an in-process asyncio queue. For distributed deployments, Kafka is recommended.

Message schemas (JSON):

```json
{
"type": "candle", "symbol": "BTCUSDT", "ts": 1692460800000,
"open": 50000.0, "high": 50050.0, "low": 49980.0, "close": 50020.0, "volume": 12.3
}
```

Signal message example:

```json
{ "type": "signal", "symbol": "BTCUSDT", "ts": 1692460800000, "signal": "BUY", "confidence": 0.78 }
```

Order request / status schemas provided in docs/binance_integration.md.

## Deployment topology
- dev: single host using Redis Streams
- staging: 2 nodes, Kafka for messaging, leader election for executor
- prod: autoscaling clusters for model inference (GPU as required), Kafka, Prometheus
Alertmanager

## Observability
- Prometheus metrics for: message lag, signal rate, trades/sec, execution latency, failed orders
- Alerts: rate-limit ban (418), >X consecutive rejects, position breach, unexplained P&L swings

## Safety
- API keys via environment variables / Vault
- Human-in-the-loop safety gate before any real-money trading

## Next steps

1. Implement module skeletons (provided in src/system)
2. Add unit tests and a replay smoke test in CI (.github/workflows/replay_test.yml)
3. Wire up Prometheus metrics and basic Grafana dashboards

--
Generated by Phase5 patch generator
